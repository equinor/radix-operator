---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.20.0
  name: radixjobs.radix.equinor.com
spec:
  group: radix.equinor.com
  names:
    kind: RadixJob
    listKind: RadixJobList
    plural: radixjobs
    shortNames:
    - rj
    singular: radixjob
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.pipeLineType
      name: Pipeline Type
      type: string
    - jsonPath: .status.targetEnvironments
      name: Target Environments
      priority: 1
      type: string
    - jsonPath: .status.condition
      name: Condition
      type: string
    - jsonPath: .status.started
      name: Started
      type: string
    - jsonPath: .status.ended
      name: Ended
      type: string
    - jsonPath: .status.reconciled
      name: Reconciled
      priority: 1
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: RadixJob describe a Radix job
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: Spec is the desired state of the RadixEnvironment
            properties:
              appName:
                description: AppName Name of the Radix application
                type: string
              applyConfig:
                description: ApplyConfig contains the configuration for apply-config
                  pipelines
                properties:
                  deployExternalDNS:
                    description: Deploy External DNS configuration
                    type: boolean
                type: object
              build:
                description: Build contains the configuration for build and build-deploy
                  pipelines
                properties:
                  branch:
                    description: |-
                      Deprecated: use GitRef instead
                      Branch, from which the image to be built
                    type: string
                  commitID:
                    description: CommitID, from which the image to be built
                    type: string
                  gitRef:
                    description: |-
                      GitRef Branch or tag to build from

                      required: false
                      example: master
                    type: string
                  gitRefType:
                    description: |-
                      GitRefType When the pipeline job should be built from branch or tag specified in GitRef:
                      - branch
                      - tag
                      - <empty> - either branch or tag

                      required false
                      enum: branch,tag,""
                      example: "branch"
                    type: string
                  imageTag:
                    description: Tag of the built image
                    type: string
                  overrideUseBuildCache:
                    description: OverrideUseBuildCache override default or configured
                      build cache option
                    type: boolean
                  pushImage:
                    description: Is the built image need to be pushed to the container
                      registry repository
                    type: boolean
                  refreshBuildCache:
                    description: RefreshBuildCache forces to rebuild cache when UseBuildCache
                      is true in the RadixApplication or OverrideUseBuildCache is
                      true
                    type: boolean
                  toEnvironment:
                    description: ToEnvironment the environment to build or build-deploy
                      to
                    type: string
                  useBuildCache:
                    description: Defaults to true and requires useBuildKit to have
                      an effect.
                    type: boolean
                  useBuildKit:
                    description: Enables BuildKit when building Dockerfile.
                    type: boolean
                required:
                - branch
                - imageTag
                type: object
              cloneURL:
                description: |-
                  Deprecated: radix-api will be responsible for setting the CloneURL, it is taken from the RadixRegistration by the radix-operator
                  CloneURL GitHub repository URL
                type: string
              deploy:
                description: Deploy contains the configuration for deploy pipelines
                properties:
                  commitID:
                    description: Commit ID connected to the deployment
                    type: string
                  componentsToDeploy:
                    description: |-
                      ComponentsToDeploy List of components to deploy
                      OPTIONAL If specified, only these components are deployed
                    items:
                      type: string
                    type: array
                  imageTagNames:
                    additionalProperties:
                      type: string
                    description: Image tags names for components - if empty will use
                      default logic
                    type: object
                  toEnvironment:
                    description: Target environment for deploy
                    type: string
                required:
                - toEnvironment
                type: object
              pipeLineType:
                description: PipeLineType Type of the pipeline
                type: string
              promote:
                description: Promote contains the configuration for promote pipelines
                properties:
                  commitID:
                    description: CommitID of the promoted deployment
                    type: string
                  deploymentName:
                    description: Name of the Radix deployment to be promoted
                    type: string
                  fromEnvironment:
                    description: Environment name, from which the Radix deployment
                      is being promoted
                    type: string
                  toEnvironment:
                    description: Environment name, to which the Radix deployment is
                      being promoted
                    type: string
                required:
                - fromEnvironment
                - toEnvironment
                type: object
              radixConfigFullName:
                description: |-
                  Deprecated: radix-api will be responsible for setting the RadixConfigFullName, it is taken from the RadixRegistration by the radix-operator
                  RadixConfigFullName Full name of the radix config file within the cloned GitHUb repository
                type: string
              stop:
                description: Stop If true, the job will be stopped
                type: boolean
              triggeredBy:
                description: TriggeredBy Name of the user or UID oa a system principal
                  which triggered the job
                type: string
              triggeredFromWebhook:
                description: TriggeredFromWebhook If true, the job was triggered from
                  a webhook
                type: boolean
            required:
            - appName
            - pipeLineType
            - triggeredBy
            type: object
          status:
            description: Status is the observed state of the RadixJob
            properties:
              condition:
                description: Condition describes the current state of the job
                type: string
              created:
                description: Created is the timestamp when the job was created
                format: date-time
                type: string
              ended:
                description: Ended is the timestamp when the job completed or failed
                format: date-time
                type: string
              message:
                description: Message provides additional information about the reconciliation
                  state, typically error details when reconciliation fails
                type: string
              observedGeneration:
                description: ObservedGeneration is the generation observed by the
                  controller
                format: int64
                type: integer
              reconcileStatus:
                description: ReconcileStatus indicates whether the last reconciliation
                  succeeded or failed
                type: string
              reconciled:
                description: Reconciled is the timestamp of the last successful reconciliation
                format: date-time
                type: string
              started:
                description: Started is the timestamp when the job started execution
                format: date-time
                type: string
              steps:
                description: Steps contains the status of each pipeline step
                items:
                  description: RadixJobStep holds status for a single step
                  properties:
                    components:
                      description: Components is the list of components processed
                        in this step
                      items:
                        type: string
                      type: array
                    condition:
                      description: Condition describes the current state of the step
                      type: string
                    ended:
                      description: Ended is the timestamp when the step completed
                        or failed
                      format: date-time
                      type: string
                    name:
                      description: Name is the name of the pipeline step
                      type: string
                    podName:
                      description: PodName is the name of the pod executing this step
                      type: string
                    started:
                      description: Started is the timestamp when the step started
                        execution
                      format: date-time
                      type: string
                  required:
                  - name
                  type: object
                type: array
              targetEnvironments:
                description: TargetEnvs is the list of target environments for the
                  job
                items:
                  type: string
                type: array
            required:
            - condition
            type: object
        required:
        - metadata
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
